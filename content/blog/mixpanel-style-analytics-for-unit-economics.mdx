---
title: Mixpanel-style Analytics For Customer Unit Economics
description: Learn how to build your own analytics and tracking tool.
date: 12-05-2023
---

import { Announcement } from '../../app/(home)/components/subscribe-v2.tsx';
import { TwitterTweetEmbed } from 'react-twitter-embed';

> üëãüèΩ Hi there. Latest update starts [here](#build-the-ingestion-api).

I didn‚Äôt write a lot of build articles this year so I‚Äôm attempting to finish off by writing one that‚Äôs a little complex. It could get pretty long so I‚Äôm going to be writing and releasing it in bits over the next two or three Mondays. I‚Äôm not very fond of frontend things so this is going to be a primarily API (first) build.

### What we‚Äôre building

A few weeks ago I came across a tweet I found pretty interesting. It was about building a Mixpanel-style analytics for customer unit economics (That‚Äôs a mouth full. Lol). I love tools like [Mixpanel](https://mixpanel.com/) and [June](https://www.june.so/) because they tell you a lot about your business and you can track even the smallest things but also because I think they take visualizing data to another level.

In his tweet, Tom talks about an _‚Äú**event-driven data architecture**‚Äù_ they have at Monzo which allows them _‚Äú**assign cost or revenue to every action a customer might take.**‚Äù_ This basically means that they would look at each customers interaction and attribute figures to their actions so they could know how much a customer had made them or how much a customer had cost them.

<TwitterTweetEmbed tweetId={'1724869506471018694'} />

Let‚Äôs use Zee, an imaginary savings firm that handles its transactions through Paystack. Each time a customer deposits funds to a fixed-term savings scheme using Paystack, Zee incurs a fee of 1.4% of the deposited sum. At the same time, they earn an interest ranging from 1 to 3% on the saved amount. In another scenario, if Zee allocates $79 monthly for their customer support tool and logs 200,000 minutes of support in a month, the cost to Zee per minute of customer support time amounts to $0.000395. Following so far?

It essentially just involves the standard method of computing costs, revenue, and ultimately profit and loss for a company. But in this case, the calculation is more granular, breaking it down to the level of each individual customer interaction.

The tool we‚Äôll use to track, measure and calculate each of these interactions is what we are building. Of course you could probably tweak an existing tool to get these results on some level but as usual I just want to show you the extent of what you can create from scratch yourself if you choose to.

### Toolstack

For this build, we‚Äôre going to use:

- [Xano](https://xano.com/) - I think Xano is an absolutely wonderful tool. I find that it‚Äôs majorly used as an external database to other no-code tools but you can also use [Xano](https://xano.com/) to build your own API products.
- [Graphy](https://graphy.app/) - Helps you visualize and share data beautifully.

### How it works

Our tool is going to work similarly to Mixpanel, capturing details of each interaction a customer has and then transmitting it to our API. The properties of these events that we capture are super important because they make the data pool that we‚Äôll analyze and transform into simple visual representations.

### Checklist

- [ ] Build the Ingestion API
  - [x] Structure the database
  - [ ] Build out the endpoints

Next up, we‚Äôll start our build from the first step - developing the ingestion API.

## Build the Ingestion API

There are two parts to building the Ingestion API, structuring our database and then developing the actual endpoints for the API. For this update we‚Äôll be focusing on structuring our database. I‚Äôm also going to try as much as possible to show you around this side of Xano.

### Intro to Xano Databases

Xano‚Äôs database works pretty much like any simple database you have come across. You can create multiple tables and in each table you can create columns for any number of field types and then you can add records on each row.

![MXB1.png](/blog/mixpanel-build/MXB1.png)

You can navigate to the Database page from the left side bar on Xano. The Dashboard page also helps give you an idea of how many tables you have in your database and how many records each table has. With the free plan, you get 100k records across your entire database.

![MXB2.png](/blog/mixpanel-build/MXB2.png)

Let‚Äôs create a simple table.

At the top right side, click on the **_Add Table_** button.

![MXB3.png](/blog/mixpanel-build/MXB3.png)

There are two ways to add a table to Xano. You can either import a csv or you can add the table manually. We‚Äôre working with the manual method. Give your table a name - in this case, **Subscribers**. Add a description and tag if you like and then click on the **_Add Table_** button on the lower right side.

![MXB4.png](/blog/mixpanel-build/MXB4.png)

When you create a table, Xano automatically adds an **_id_** and **_created_at_** field. The id field assigns a number value to each record, you can always add your own unique id field if you prefer. The created_at field helps you know the exact time a record was created.

For our Subscribers table, we are going to add a Name and Email field. To add a new field, click on the plus icon.

![MXB5.png](/blog/mixpanel-build/MXB5.png)

There are many field types supported by Xano. You can read all about them [here](https://docs.xano.com/database/field-types). In our case, we just need the Text and Email field type.

![MXB6.png](/blog/mixpanel-build/MXB6.png)

Select Text field type, give it a name then choose between yes or no for the required option and save. Do the same for the Email field type as well.

![MXB7.png](/blog/mixpanel-build/MXB7.png)

This is how our table looks like once the fields are added. You can click on the **_Add new record_** button to add a new subscriber or you can add one via an API. We‚Äôll get to that when we‚Äôre building out endpoints.

![MX8.png](/blog/mixpanel-build/MX8.png) _This is how the Database page looks when you have a table._

### Structuring our database

Now that you have some idea on how to create tables in Xano, we can start to structure our databases.

Let‚Äôs think about how our tool works again to try to determine how . For every particular **action** a **customer** takes, we want to send an **event.** If you guessed that we need 3 tables, you guessed right.

**Actions**

Actions are what we are assigning numerical value to so we know how much a customer cost or made us when they take it. It is from these actions that we derive the metrics that we will be tracking. You can have as many actions as possible and you can have multiple metrics from one action. Here are some examples to help you understand:

| Action                                       | Metrics         | Type    |
| -------------------------------------------- | --------------- | ------- |
| When a customer speaks to a support rep      | support-minutes | Cost    |
| When a customer makes a fixed plan deposit   | processing-fees | Cost    |
| When a customer makes a fixed plan deposit   | interest-earned | Revenue |
| When a customer successfully refers a friend | referrer-reward | Cost    |
| When a customer successfully refers a friend | referee-spend   | Revenue |

Let‚Äôs go through the examples briefly using our imaginary savings startup Zee. When a customer speaks to a support representative, Zee tracks the support minutes to know how much each customer costs them in terms of support.

When a customer makes a deposit to a fixed savings plan, Zee tracks how much in processing fees that deposit has cost them, they also track how much in interest they will be getting from that locked deposit.

And finally, when a customer successfully refers a friend to Zee, that customer costs Zee a certain amount that they will pay as a reward for the referral but Zee will also track how much they will make from the amount the referred friend spends.

This is our first database table.

**Events**

To continuously log these actions as they happen, they‚Äôll be sent as **Events**. Every time a customer takes that action, we‚Äôll pass them to the API along with the value of what that action costs or makes. Here‚Äôs another example to help you understand:

| Action | Metrics | Type | Value |
| --- | --- | --- | --- |
| When a customer speaks to a support rep | support-minutes | Cost | $0.000395 x Minutes spent by customer |
| When a customer makes a fixed plan deposit | processing-fees | Cost | 1.4% of the amount deposited |
| When a customer makes a fixed plan deposit | interest-earned | Revenue | 2% of the amount deposited |
| When a customer successfully refers a friend | referrer-reward | Cost | N500 |
| When a customer successfully refers a friend | referee-spend | Revenue | 2% of the amount deposited |

The cost of speaking to the support rep is the total number of minutes spent multiplied by the single cost of a minute like we calculated above. So if the customer spent 20 minutes, the value that will be passed in this event will be $0.0079.

If the customer made a deposit of N300,000 into their fixed savings account, this would have cost Zee N4200 but it would have also made them N6000. If you do the math further you can tell whether they made a profit or loss based on this single action by their customer.

If the customer makes a successful referral to their friend, Zee would have to spend N500 as a reward to the customer for bringing in a friend but if the customer‚Äôs friend deposited N500,000, this means that Zee also earned N10,000.

This is our second table.

**Customer**

The Customer table is the third and last database table that we need. It tells us who took an action, when and how many times the event happened.

Now let‚Äôs create the tables. We‚Äôll identify the properties we need for each column and their field type. Remember there‚Äôs a default id and created_at field with each table.

**Metrics Table (Actions)**

| Field Name/Property | Field Type | Description | Required? |
| --- | --- | --- | --- |
| `name` | Text | Metric name e.g support-minutes | Yes |
| `unique_id` | Text | A unique id. Preferably UUID | Yes |
| `description` | Text | The action or metric description | No |
| `type` | Enum (Cost, Revenue) | Whether cost or revenue | Yes |
| `total_number_of_events` | Integer | Total events logged for this metric | Yes |

**Events Table**

| Field Name/Property | Field Type | Description | Required? |
| --- | --- | --- | --- |
| `metric` | Text | The metric being tracked | Yes |
| `unique_id` | Text | A unique id. Preferably UUID | Yes |
| `value` | Integer | The value of the metric tracked | Yes |
| `customer` | Table Reference | The customer who took the action | Yes |

**Customers Table**

| Field Name/Property | Field Type | Description | Required? |
| --- | --- | --- | --- |
| `name` | Text | Name of customer | Yes |
| `unique_id` | Text | A unique id. Preferably UUID | Yes |
| `additional_properties` | JSON | Additional info about the customer | No |

Next, we‚Äôll build out the functions for the API.

> üìå I'll be releasing the second update for the build next Monday. If you're subscribed to my newsletter, you'll receive the update before I share it publicly. Catch you next week!
